<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline';">
    <title>Dicion√°rio Pessoal</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="app-container">
        <header class="app-header">
            <h1>üìö Dicion√°rio Pessoal</h1>
            <p class="subtitle">Seu dicion√°rio personalizado para toda a m√°quina</p>
        </header>

        <div class="toolbar">
            <div class="search-container">
                <input type="text" id="searchInput" placeholder="üîç Buscar palavra..." autocomplete="off">
                <button id="clearSearch" class="btn-clear" title="Limpar busca">√ó</button>
            </div>
            
            <div class="action-buttons">
                <button id="addWordBtn" class="btn-primary" title="Adicionar nova palavra">
                    ‚ûï Adicionar Palavra
                </button>
                <button id="importBtn" class="btn-secondary" title="Importar dicion√°rio da extens√£o">
                    üì• Importar
                </button>
                <button id="exportBtn" class="btn-secondary" title="Exportar dicion√°rio">
                    üì§ Exportar
                </button>
                <button id="settingsBtn" class="btn-settings" title="Configura√ß√µes">
                    ‚öôÔ∏è
                </button>
            </div>
        </div>

        <div class="main-content">
            <!-- Lista de palavras -->
            <div class="dictionary-section">
                <div class="section-header">
                    <h3>Palavras no Dicion√°rio</h3>
                    <span id="wordCount" class="word-count">0 palavras</span>
                </div>
                
                <div id="dictionaryList" class="dictionary-list">
                    <div id="emptyState" class="empty-state">
                        <div class="empty-icon">üìñ</div>
                        <h3>Dicion√°rio vazio</h3>
                        <p>Adicione suas primeiras palavras ou importe um dicion√°rio existente.</p>
                        <button class="btn-primary" onclick="document.getElementById('addWordBtn').click()">
                            Adicionar primeira palavra
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal para adicionar/editar palavra -->
        <div id="wordModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="modalTitle">Adicionar Palavra</h3>
                    <button class="modal-close" id="closeModal">√ó</button>
                </div>
                
                <div class="modal-body">
                    <div class="form-group">
                        <label for="wordInput">Palavra/Termo:</label>
                        <input type="text" id="wordInput" placeholder="Digite a palavra ou termo..." autocomplete="off">
                    </div>
                    
                    <div class="form-group">
                        <label for="definitionInput">Defini√ß√£o:</label>
                        <textarea id="definitionInput" placeholder="Digite a defini√ß√£o ou descri√ß√£o..." rows="6"></textarea>
                    </div>
                    
                    <div class="ai-section">
                        <h4>ü§ñ Gerar defini√ß√£o com IA:</h4>
                        <div class="ai-buttons">
                            <button class="btn-ai" data-provider="openai">OpenAI</button>
                            <button class="btn-ai" data-provider="anthropic">Anthropic</button>
                            <button class="btn-ai" data-provider="google">Google AI</button>
                        </div>
                        <div id="aiStatus" class="ai-status"></div>
                    </div>
                </div>
                
                <div class="modal-footer">
                    <button id="cancelBtn" class="btn-secondary">Cancelar</button>
                    <button id="saveWordBtn" class="btn-primary">Salvar</button>
                    <button id="deleteWordBtn" class="btn-danger" style="display: none;">Excluir</button>
                </div>
            </div>
        </div>

        <!-- Modal de configura√ß√µes -->
        <div id="settingsModal" class="modal">
            <div class="modal-content settings-modal">
                <div class="modal-header">
                    <h3>‚öôÔ∏è Configura√ß√µes</h3>
                    <button class="modal-close" id="closeSettings">√ó</button>
                </div>
                
                <div class="settings-tabs">
                    <button class="tab-button active" data-tab="general">üé® Geral</button>
                    <button class="tab-button" data-tab="hotkeys">‚å®Ô∏è Atalhos</button>
                    <button class="tab-button" data-tab="ai">ü§ñ IA</button>
                </div>
                
                <div class="modal-body">
                    <!-- Aba Geral -->
                    <div id="generalTab" class="tab-content active">
                        <div class="settings-section">
                            <h4>üé® Interface</h4>
                            <div class="form-group">
                                <label for="popupTimeout">Tempo do popup (segundos):</label>
                                <input type="number" id="popupTimeout" min="1" max="30" value="10">
                                <small>Tempo que o popup permanece vis√≠vel ap√≥s capturar texto</small>
                            </div>
                            <div class="form-group">
                                <label for="popupWidth">Largura do popup (pixels):</label>
                                <input type="number" id="popupWidth" min="200" max="800" value="350">
                            </div>
                            <div class="form-group">
                                <label for="popupHeight">Altura do popup (pixels):</label>
                                <input type="number" id="popupHeight" min="100" max="600" value="200">
                            </div>
                            <div class="form-group checkbox-group">
                                <label>
                                    <input type="checkbox" id="startWithSystem">
                                    Iniciar com o sistema
                                </label>
                                <small>A aplica√ß√£o iniciar√° automaticamente quando o computador for ligado</small>
                            </div>
                        </div>
                        
                        <div class="settings-section">
                            <h4>ÔøΩ Dados</h4>
                            <div class="form-group checkbox-group">
                                <label>
                                    <input type="checkbox" id="autoBackup">
                                    Backup autom√°tico
                                </label>
                                <small>Criar backup autom√°tico do dicion√°rio diariamente</small>
                            </div>
                            <div class="form-group">
                                <label for="maxBackups">M√°ximo de backups:</label>
                                <input type="number" id="maxBackups" min="1" max="50" value="10">
                                <small>N√∫mero m√°ximo de backups a manter</small>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Aba Atalhos -->
                    <div id="hotkeysTab" class="tab-content">
                        <div class="settings-section">
                            <h4>‚å®Ô∏è Atalhos Globais</h4>
                            <div class="form-group">
                                <label>Capturar texto selecionado:</label>
                                <div class="hotkey-input">
                                    <input type="text" id="captureHotkey" readonly>
                                    <button class="btn-secondary" onclick="recordHotkey('capture')">Alterar</button>
                                </div>
                                <small>Selecione texto em qualquer aplica√ß√£o e pressione este atalho</small>
                            </div>
                            <div class="form-group">
                                <label>Mostrar/ocultar dicion√°rio:</label>
                                <div class="hotkey-input">
                                    <input type="text" id="toggleHotkey" readonly>
                                    <button class="btn-secondary" onclick="recordHotkey('toggle')">Alterar</button>
                                </div>
                                <small>Atalho para abrir esta janela</small>
                            </div>
                            <div class="hotkey-recording" id="hotkeyRecording" style="display: none;">
                                <p>üéØ Pressione a combina√ß√£o desejada...</p>
                                <button class="btn-secondary" onclick="cancelHotkeyRecord()">Cancelar</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Aba IA -->
                    <div id="aiTab" class="tab-content">
                        <div class="settings-section">
                            <h4>ü§ñ Configura√ß√£o de IA</h4>
                            <p class="ai-description">Configure suas chaves de API para gerar defini√ß√µes automaticamente</p>
                            
                            <div class="ai-providers">
                                <!-- OpenAI -->
                                <div class="ai-provider-card">
                                    <div class="ai-provider-header">
                                        <h5>üî• OpenAI (ChatGPT)</h5>
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="openaiEnabled">
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                    <div class="ai-provider-content" id="openaiConfig">
                                        <div class="form-group">
                                            <label for="openaiKey">API Key:</label>
                                            <input type="password" id="openaiKey" placeholder="sk-proj-...">
                                            <button class="btn-test" onclick="testApiKey('openai')">Testar</button>
                                        </div>
                                        <div class="form-group">
                                            <label for="openaiModel">Modelo:</label>
                                            <select id="openaiModel">
                                                <option value="gpt-4o-mini">GPT-4o Mini (Recomendado)</option>
                                                <option value="gpt-4o">GPT-4o</option>
                                                <option value="gpt-3.5-turbo">GPT-3.5 Turbo</option>
                                            </select>
                                        </div>
                                        <small>üîó Obtenha em: <a href="#" onclick="openExternal('https://platform.openai.com/api-keys')">platform.openai.com/api-keys</a></small>
                                    </div>
                                </div>
                                
                                <!-- Anthropic -->
                                <div class="ai-provider-card">
                                    <div class="ai-provider-header">
                                        <h5>üß† Anthropic (Claude)</h5>
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="anthropicEnabled">
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                    <div class="ai-provider-content" id="anthropicConfig">
                                        <div class="form-group">
                                            <label for="anthropicKey">API Key:</label>
                                            <input type="password" id="anthropicKey" placeholder="sk-ant-...">
                                            <button class="btn-test" onclick="testApiKey('anthropic')">Testar</button>
                                        </div>
                                        <div class="form-group">
                                            <label for="anthropicModel">Modelo:</label>
                                            <select id="anthropicModel">
                                                <option value="claude-3-haiku-20240307">Claude 3 Haiku (R√°pido)</option>
                                                <option value="claude-3-5-sonnet-20241022">Claude 3.5 Sonnet (Recomendado)</option>
                                                <option value="claude-3-opus-20240229">Claude 3 Opus (Melhor qualidade)</option>
                                            </select>
                                        </div>
                                        <small>üîó Obtenha em: <a href="#" onclick="openExternal('https://console.anthropic.com/')">console.anthropic.com</a></small>
                                    </div>
                                </div>
                                
                                <!-- Google AI -->
                                <div class="ai-provider-card">
                                    <div class="ai-provider-header">
                                        <h5>üåü Google AI (Gemini)</h5>
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="googleEnabled">
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                    <div class="ai-provider-content" id="googleConfig">
                                        <div class="form-group">
                                            <label for="googleKey">API Key:</label>
                                            <input type="password" id="googleKey" placeholder="AIza...">
                                            <button class="btn-test" onclick="testApiKey('google')">Testar</button>
                                        </div>
                                        <div class="form-group">
                                            <label for="googleModel">Modelo:</label>
                                            <select id="googleModel">
                                                <option value="gemini-1.5-flash">Gemini 1.5 Flash (Recomendado)</option>
                                                <option value="gemini-1.5-pro">Gemini 1.5 Pro</option>
                                                <option value="gemini-pro">Gemini Pro</option>
                                            </select>
                                        </div>
                                        <small>üîó Obtenha em: <a href="#" onclick="openExternal('https://aistudio.google.com/app/apikey')">aistudio.google.com/app/apikey</a></small>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="ai-settings">
                                <h5>‚öôÔ∏è Configura√ß√µes Avan√ßadas</h5>
                                <div class="form-group">
                                    <label for="aiTemperature">Criatividade (Temperature):</label>
                                    <input type="range" id="aiTemperature" min="0" max="1" step="0.1" value="0.3">
                                    <span class="range-value">0.3</span>
                                    <small>0 = Mais conservador, 1 = Mais criativo</small>
                                </div>
                                <div class="form-group">
                                    <label for="aiMaxTokens">Tamanho m√°ximo da resposta:</label>
                                    <input type="number" id="aiMaxTokens" min="50" max="500" value="150">
                                    <small>N√∫mero m√°ximo de tokens (palavras) na defini√ß√£o</small>
                                </div>
                                <div class="form-group checkbox-group">
                                    <label>
                                        <input type="checkbox" id="aiAutoSave">
                                        Salvar automaticamente defini√ß√µes geradas
                                    </label>
                                    <small>Salva no dicion√°rio automaticamente ap√≥s gerar com IA</small>
                                </div>
                            </div>
                            
                            <div class="ai-status" id="aiTestStatus"></div>
                        </div>
                    </div>
                </div>
                
                <div class="modal-footer">
                    <button id="resetSettingsBtn" class="btn-secondary">Restaurar Padr√µes</button>
                    <button id="saveSettingsBtn" class="btn-primary">Salvar Configura√ß√µes</button>
                </div>
            </div>
        </div>

        <!-- Modal de importa√ß√£o -->
        <div id="importModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>üì• Importar Dicion√°rio</h3>
                    <button class="modal-close" id="closeImport">√ó</button>
                </div>
                
                <div class="modal-body">
                    <div class="import-section">
                        <h4>Da Extens√£o do Browser</h4>
                        <p>1. Abra a extens√£o no seu navegador</p>
                        <p>2. Abra o console (F12) e execute o comando:</p>
                        <code class="copy-code" onclick="copyToClipboard(this.textContent)">
chrome.storage.sync.get({dictionary: {}}, function(data) {
  console.log(JSON.stringify(data.dictionary, null, 2));
});
                        </code>
                        <p>3. Cole o resultado JSON aqui:</p>
                        <textarea id="importData" placeholder="Cole aqui o JSON do dicion√°rio..." rows="8"></textarea>
                    </div>
                    
                    <div class="import-section">
                        <h4>Arquivo JSON</h4>
                        <input type="file" id="fileInput" accept=".json" style="display: none;">
                        <button class="btn-secondary" onclick="document.getElementById('fileInput').click()">
                            üìÅ Selecionar Arquivo JSON
                        </button>
                        <div id="fileStatus"></div>
                    </div>
                </div>
                
                <div class="modal-footer">
                    <button id="cancelImport" class="btn-secondary">Cancelar</button>
                    <button id="confirmImport" class="btn-primary">Importar</button>
                </div>
            </div>
        </div>

        <!-- Status bar -->
        <footer class="status-bar">
            <div class="status-info">
                <span id="statusText">Pronto ‚Ä¢ Use Ctrl+Shift+D para capturar texto</span>
            </div>
            <div class="status-actions">
                <span class="hotkey-hint">Ctrl+Shift+D: Capturar ‚Ä¢ Ctrl+Alt+D: Mostrar/Ocultar</span>
            </div>
        </footer>
    </div>

    <script src="app.js"></script>
</body>
</html>